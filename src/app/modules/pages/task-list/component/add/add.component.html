<mat-card class="addDeploy">
  <form (ngSubmit)="submitForm()" class="w-100">
    <mat-card-header class="form-header w-100 d-flex justify-content-between align-items-center">
      <mat-card-title class="main-title">New Deployment</mat-card-title>
      <div class="d-flex justify-content-end gap-1 align-items-center ">
        <mat-label class="me-2 fw-bold fs-5">Regions:</mat-label>
        <div class="d-flex flex-wrap gap-2">
          <mat-checkbox
            *ngFor="let region of regions; let r = index"
            [(ngModel)]="region.selected"
            [name]="'region_' + r"
            [id]="region.name"
            color="primary"
            class="region-checkbox"
          >
            {{ region.name | uppercase }}
          </mat-checkbox>
        </div>
      </div>
    </mat-card-header>

    <mat-card-content class="p-3">
      <!-- Deployment Options Section -->
      <div class="form-section">
        <div class="option-grid">
          <mat-checkbox
            *ngFor="let field of deploymentFields; let i = index"
            [(ngModel)]="field.selected"
            [name]="'deploymentField_' + i"
            class="checkbox"
            color="primary"
          >
            {{ field.label | titlecase }}
          </mat-checkbox>
        </div>
      </div>
      <!-- Configuration Section -->
      <div class="form-section option-grid">

        <!-- Lambda to Deploy Dropdown -->
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Lambda Functions to Deploy</mat-label>
          <mat-select
            [(ngModel)]="selectedLambdas"
            name="selectedLambdas"
            multiple
            placeholder="Select lambda functions"
          >
            <mat-select-trigger>
              <span *ngIf="selectedLambdas.length === 0">No lambdas selected</span>
              <span *ngIf="selectedLambdas.length === 1">{{selectedLambdas[0]}}</span>
              <span *ngIf="selectedLambdas.length > 1">
                {{selectedLambdas.length}} lambdas selected
              </span>
            </mat-select-trigger>
            <mat-option *ngFor="let lambda of lambdaOptions" [value]="lambda">
              {{ lambda }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <!-- Scripts Section -->
      <div class="form-section">
        <div class="d-flex justify-content-start gap-3 align-items-center">
          <h2>Scripts Configuration:</h2>
          <div class="d-flex gap-3">
            <mat-checkbox
              *ngFor="let script of scriptsOptions; let j = index"
              [(ngModel)]="scripts[script]"
              [name]="'script_' + j"
              [id]="'script_' + script"
              class="checkbox pe-5"
              color="primary"
            >
              <div class="script-label">
                <span class="script-name">{{ script | titlecase }}</span>
              </div>
            </mat-checkbox>
          </div>
        </div>
      </div>
    </mat-card-content>

    <!-- Action Buttons -->
    <mat-card-actions class="form-actions">
      <button
        mat-raised-button
        color="primary"
        type="submit"
        class="deploy-button"
        [disabled]="!isFormValid()"
      >
        <mat-icon>rocket_launch</mat-icon>
        Deploy Now
      </button>

      <button
        mat-stroked-button
        type="button"
        class="preview-button"
        (click)="previewConfig()"
      >
        <mat-icon>preview</mat-icon>
        Preview Configuration
      </button>

      <button
        mat-button
        type="button"
        class="reset-button"
        (click)="resetForm()"
      >
        <mat-icon>refresh</mat-icon>
        Reset
      </button>
    </mat-card-actions>
  </form>
</mat-card>
